
<html>
    <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>New Dataset</title>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
            <link rel="stylesheet" href="https://getbootstrap.com/docs/5.3/assets/css/docs.css">
            <link rel="stylesheet" href="{{ url_for('static', filename='template.css') }}">      

    </head>
  <body>

  <div class="wrapper">
    <div class="sidebar">
        <div class="fs-5 text-center" style="height: 5rem;">Recommender System</div>
        <ul>
            <li><a href="#"><i class="fas fa-home"></i>Main</a></li>
            <li><a href="/newdataset"><i class="fas fa-user"></i>New Dataset</a></li>
            <li><a href="#"><i class="fas fa-address-card"></i>Lorem Ipsum</a></li>
        </ul> 
    </div>
    <div class="container-fluid main_content p-0">
      <div class="row g-3">
        <div class="bg-primary">
              <div class="text-center fs-1 text-warning">Recommender System</div>
        </div>
        <!-- Search Bar -->
        <div class="col-12 bg-warning">
          <div class="card">
            <div class="row">
              <div class="col-12 text-center align-middle fs-5"> Upload your CSV file below to update Dataset for better prediction and recommendation result </div>
              <div class="col-12">
                <div class="p-2 w-25 d-inline-block">
                  <form action="brandtype" name="LoadListItems" method="POST">
                    <!-- Content -->
                </form>
              </div>
              </div>
            </div>
          </div>
        </div>
        <!-- End Search Bar -->
        <div class="col-6">
          <div class="card">
            <div class="card-header"><h6>Choose File to upload ".csv" file only. Please use proper formatting.</h6></div>
              <div class="card-body col"> 
                <h6 class="card-title"> <b> </b></h6>
                <form name="upload_file_csv" action="/uploadCSV" method="POST"  enctype="multipart/form-data" >
                  <div class="input-group mb-3">
                    <input type="file" class="form-control" name="csvfile">
                    <!-- <label class="input-group-text" value= "Upload" onclick="this.form.submit()">Upload</label> -->
                    <input type="button" class="input-group-text d-inline" value= "Upload" onclick="this.form.submit()">
                  </div>
                </form>
          </div>   
        </div>
        </div>
        <div class="col-6">
          <div class="card">
            <div class="card-header"><h6>CSV file Format</h6></div>
              <div class="card-body col"> 
                <h6 class="card-title"> <b> Note and Instruction  </b></h6>
                <div class="mb-3">
                  Lorem ipsum dolor sit amet consectetur adipisicing elit. Et, quod? Molestiae voluptates dolor laboriosam ipsam nesciunt, numquam excepturi vero architecto saepe deserunt, soluta voluptate quisquam. Voluptatibus dolore laborum fugit architecto.
                </div>
          </div>   
        </div>
        </div>
        <div class="col-12">
          <div class="card">
            <div class="card-header"><h6>Image Upload</h6></div>
              <div class="card-body col"> 
                <div class="cust_uploadfile" id="drop-area-container">
                  <label for="input-file" id="cust_drop-area">
                      <div id="cust_image-preview">dsfsd</div>
                  </label>
                  <div id="cust_url-display"></div>     
                </div>
          </div>   
        </div>
        </div>
        <div class="col-12">
          <div class="card">
            <div class="card-header"><h6>CSV file Format</h6></div>
              <div class="card-body col"> 
                <h6 class="card-title"> <b> </b></h6>
                <div class="mb-3">
                  {{df_html | safe}}
                </div>
          </div>   
        </div>
        </div>
        <script>
          const dropArea = document.getElementById('cust_drop-area-container');
const imagePreview = document.getElementById('cust_image-preview');
const urlDisplay = document.getElementById('cust_url-display');

// Prevent default drag behaviors
['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
  dropArea.addEventListener(eventName, preventDefaults, false);
});

function preventDefaults(e) {
  e.preventDefault();
  e.stopPropagation();
}

// Highlight drop area when item is dragged over it
['dragenter', 'dragover'].forEach(eventName => {
  dropArea.addEventListener(eventName, highlight, false);
});

['dragleave', 'drop'].forEach(eventName => {
  dropArea.addEventListener(eventName, unhighlight, false);
});

function highlight(e) {
  dropArea.style.borderColor = '#007bff';
}

function unhighlight(e) {
  dropArea.style.borderColor = '#ccc';
}

// Handle dropped data
dropArea.addEventListener('drop', handleDrop, false);

function handleDrop(e) {
  e.preventDefault();
  const data = e.dataTransfer.getData('text/uri-list') || e.dataTransfer.getData('text/plain');

  if (data) {
    if (isValidImageUrl(data)) {
      // imagePreview.src = data;
      // imagePreview.style.display = 'block';
      imagePreview.style.backgroundImage =`url(${data})`
      urlDisplay.textContent = `Image URL: ${data}`;
      
    } else {
      urlDisplay.textContent = 'Invalid Image URL';
      // imagePreview.style.display = 'none';
    }
  }
}

function isValidImageUrl(url) {
  try {
    const parsedUrl = new URL(url);
    const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp']; // Add more if needed
    const lowerCaseUrl = parsedUrl.pathname.toLowerCase();
    return imageExtensions.some(extension => lowerCaseUrl.endsWith(extension));
  } catch (_) {
    return false;
  }
}
        </script>
    </body>
</html>